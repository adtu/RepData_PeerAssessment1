activity_nona[930:940,]
activity_intervalmean[2500:2515,]
activity_nona[2500:2515,]
activity_imputed <- activity_intervalmean[, 1:3]
dailytotal_imputed <- aggregate(steps ~ date, data=activity_imputed, sum)
hist(dailytotal_imputed$steps, col = "red", xlab = "Daily Total Steps", main = "Histogram of Daily Total Steps")
stepmean
stepmedian
stepmean_imputed <- round(mean(dailytotal_imputed$steps))
stepmedian_imputed <- median(dailytotal_imputed$steps)
stepmean_impute
stepmean_imputed
stepmedian_imputed
dailytotal <- aggregate(steps ~ date, data=activity, sum)
hist(dailytotal$steps, col = "green", xlab = "Daily Total Steps", main = "Histogram of Daily Total Steps")
dailytotal_imputed <- aggregate(steps ~ date, data=activity_imputed, sum)
hist(dailytotal_imputed$steps, col = "red", xlab = "Daily Total Steps", main = "Histogram of Daily Total Steps")
dailytotal <- aggregate(steps ~ date, data=activity, sum, na.rm = TRUE)
hist(dailytotal$steps, col = "green", xlab = "Daily Total Steps", main = "Histogram of Daily Total Steps")
stepmean <- round(mean(dailytotal$steps))
stepmedian <- median(dailytotal$steps)
stepmean
stepmedian
activity_imputed[625:630,]
activity[625:630,]
activity[1:10,]
activity_imputed[1:10,]
dailytotal <- aggregate(steps ~ date, data=activity, sum, na.rm = TRUE)
str(dailytotal)
summary(dailytotal)
dailytotal <- aggregate(steps ~ date, data=activity, sum)
summary(dailytotal)
str(dailytotal)
dailytotal <- aggregate(steps ~ date, data=activity, sum, na.rm = FALSE)
str(dailytotal)
summary(dailytotal)
str(activity)
activitynona <- !is.na(activity)
str(activitynona)
head(activitynona)
activitynona <- activity[!is.na(activity),]
head(activitynona)
str(activitynona)
dailytotalnona <- aggregate(steps ~ date, data=activitynona, sum, na.rm = TRUE)
str(dailynona)
str(dailytotalnona)
head(dailytotalnona)
head(dailytotal)
str(activitynona)
str(activity)
head(activitynona)
head(activity)
hist(dailytotalnona$steps, col = "green", xlab = "Daily Total Steps", main = "Histogram of Daily Total Steps")
summary(dailytotal)
summary(dailytotalnona)
str(dailytotal)
str(dailytotalnona)
str(activitynona)
str(activity)
str(activity)
activitynona <- activity[!is.na(activity$steps),]
str(activitynona)
nrow(activity[activity$steps == "NA",]
)
dailytotalnona <- aggregate(steps ~ date, data=activitynona, sum, na.rm = TRUE)
hist(dailytotalnona$steps, col = "green", xlab = "Daily Total Steps", main = "Histogram of Daily Total Steps")
str(dailynona)
str(dailytotalnona)
dailytotalnona <- aggregate(steps ~ date, data=activitynona, sum)
str(dailytotalnona)
str(activitynona)
str(activity)
hist(dailytotalnona$steps, col = "blue", xlab = "Daily Total Steps", main = "Histogram of Daily Total Steps")
head(activity)
head(activitynona)
head(dailytotal)
head(dailytotalnona)
library(knitr)
opts_chunk$set(echo = TRUE, results = "asis")
options(scipen = 1)
activity <- read.csv("./activity.csv", header=T, colClasses = c("numeric", "character", "numeric"))
activity$date <- as.Date(activity$date, format="%Y-%m-%d")
activitynona <- activity[!is.na(activity$steps),]
dailytotal <- aggregate(steps ~ date, data=activity, sum, na.rm = TRUE)
hist(dailytotal$steps, col = "green", xlab = "Daily Total Steps", main = "Histogram of Daily Total Steps")
dailytotalnona <- aggregate(steps ~ date, data=activitynona, sum, na.rm = TRUE)
hist(dailytotalnona$steps, col = "green", xlab = "Daily Total Steps", main = "Histogram of Daily Total Steps")
dailytotalnona <- aggregate(steps ~ date, data=activitynona, sum, na.rm = TRUE)
hist(dailytotalnona$steps, col = "red", xlab = "Daily Total Steps", main = "Histogram of Daily Total Steps")
dailytotalnona <- aggregate(steps ~ date, data=activitynona, sum, na.rm = TRUE)
hist(dailytotalnona$steps, col = "blue", xlab = "Daily Total Steps", main = "Histogram of Daily Total Steps")
stepmean <- round(mean(dailytotal$steps))
stepmedian <- median(dailytotal$steps)
stepmean
stepmedian
stepmean <- round(mean(dailytotalnona$steps))
stepmedian <- median(dailytotalnona$steps)
stepmean <- round(mean(dailytotal$steps))
stepmedian <- median(dailytotal$steps)
stepmeannona <- round(mean(dailytotalnona$steps))
stepmediannona <- median(dailytotalnona$steps)
stepmean
stepmedian
stepmeannona
stepmediannona
str(activitynona)
library(knitr)
opts_chunk$set(echo = TRUE, results = "asis")
options(scipen = 1)
activity <- read.csv("./activity.csv", header=T, colClasses = c("numeric", "character", "numeric"))
activity$date <- as.Date(activity$date, format="%Y-%m-%d")
dailytotal <- aggregate(steps ~ date, data=activity, sum, na.rm = TRUE)
hist(dailytotal$steps, col = "green", xlab = "Daily Total Steps", main = "Histogram of Daily Total Steps")
stepmean <- round(mean(dailytotal$steps))
stepmedian <- median(dailytotal$steps)
stepmean
stepmedian
intervalmean <- aggregate(steps ~ interval, data=activity, mean)
with(intervalmean, plot(interval, steps, type = "l", main = "Average Steps by 5-minute Interval"))
maxavgrow <- intervalmean[intervalmean$steps == max(intervalmean$steps),]
maxavginterval <- maxavgrow$interval
maxavginterval <- maxavgrow$interval
maxavginterval
nacount <- nrow(activity[activity$steps == "NA",])
nacount
intervalmean <- aggregate(steps ~ interval, data=activity, mean)
names(intervalmean) <- c("interval", "avgsteps")
activity_intervalmean <- merge(activity, intervalmean)
activity_intervalmean <- activity_intervalmean[order(activity_intervalmean$date),]
activity_intervalmean$steps <- ifelse(is.na(activity_intervalmean$steps),
activity_intervalmean$avgsteps, activity_intervalmean$steps)
activity_imputed <- activity_intervalmean[, 1:3]
str(activity_imputed)
activity_imputed[625:630]
activity_imputed[625:630,]
activity_intervalmean[625:630,]
activity_intervalmean[625:630,]
activity[625:630,]
activity_imputed[935:940,]
activity_intervalmean[935:940,]
activity[935:940,]
dailytotal_imputed <- aggregate(steps ~ date, data=activity_imputed, sum)
hist(dailytotal_imputed$steps, col = "red", xlab = "Daily Total Steps", main = "Histogram of Daily Total Steps")
dailytotal_imputed <- aggregate(steps ~ date, data=activity_imputed, sum)
hist(dailytotal_imputed$steps, col = "red", xlab = "Daily Total Steps", main = "Histogram of Daily Total Steps (imputed NA's")
dailytotal_imputed <- aggregate(steps ~ date, data=activity_imputed, sum)
hist(dailytotal_imputed$steps, col = "red", xlab = "Daily Total Steps", main = "Histogram of Daily Total Steps (imputed NA's)")
stepmean_imputed <- round(mean(dailytotal_imputed$steps))
stepmedian_imputed <- round(median(dailytotal_imputed$steps))
stepmean_imputed
stepmedian_imputed
dailytotal <- aggregate(steps ~ date, data=activity, sum, na.rm = TRUE)
hist(dailytotal$steps, col = "green", xlab = "Daily Total Steps", main = "Histogram of Daily Total Steps")
dailytotal <- aggregate(steps ~ date, data=activity, sum)
hist(dailytotal$steps, col = "green", xlab = "Daily Total Steps", main = "Histogram of Daily Total Steps")
activity_imputed[1:5, date]
activity_imputed$date[1:5]
weekdays(activity_imputed$date[1:5])
weekdays(activity_imputed$date[100:110])
weekdays(activity_imputed$date[280-290])
weekdays(activity_imputed$date[280:290])
weekdays(activity_imputed$date[560:565])
weekdays(activity$date[560:565])
activity_imputed$date[560:565]
?factor
activity_imputed$wkdy <- factor(weekday(activity_imputed$date), labels = c("Weekday", "Wekkend"))
activity_imputed$wkdy <- factor(weekdays(activity_imputed$date), labels = c("Weekday", "Wekkend"))
wkdy <- factor(weekdays(activity_imputed$date), labels = c("Weekday", "Wekkend"))
wkdy <- factor(weekdays(activity_imputed$date), labels = c("Weekday", "Weekend"))
nacount
stepmean <- round(mean(dailytotal$steps, na.rm=TRUE))
stepmean
stepmedian <- median(dailytotal$steps, na.rm=TRUE))
stepmedian <- median(dailytotal$steps, na.rm=TRUE)
stepmedian
stepmean_imputed
stepmedian_imputed
activity_imputed$wkdy <- factor(weekday(activity_imputed$date), labels = c("weekday", "weekend"))
set.seed(10)
x <- rnorm(100)
f <- rep(0:1, each = 50)
y <- x + f + f*x + rnorm(100, sd = 0.5)
f <- factor(f, labels = c("Group 1", "Group 2"))
xyplot(y ~ x | f, layout = c(2, 1))
library(lattice)
set.seed(10)
x <- rnorm(100)
f <- rep(0:1, each = 50)
y <- x + f + f*x + rnorm(100, sd = 0.5)
f <- factor(f, labels = c("Group 1", "Group 2"))
xyplot(y ~ x | f, layout = c(2, 1))
str(f)
head(f)
f <- rep(0:1, each = 50)
head(f)
tail(f)
?weekday()
weekday(activity_imputed$date[260:265])
weekdays(activity_imputed$date[260:265])
weekdays(activity_imputed$date[266:272])
weekdays(activity_imputed$date[263:27])
weekdays(activity_imputed$date[263:270])
head(f)
head(f,20)
tail(f,20)
f <- factor(f, labels = c("Group 1", "Group 2"))
head(f)
activity_imputed$wkdy <- factor(weekdays(activity_imputed$date), levels = c("Monday", "Tuesday", "Wednesday", Thursday", Friday", "Saturday", "Sunday"), labels = c("weekday", "weekend"))
activity_imputed$wkdy <- weekdays(activity_imputed$date)
str(activity_imputed)
activity_imputed$wkdy <- factor(activity_imputed$wkdy, labels = c("weekday", "weekend"))
?factor()
activity_imputed$wkdy <- factor(activity_imputed$wkdy)
str(activity_imputed)
activity_imputed$wkdy <- weekdays(activity_imputed$date)
activity_imputed <- activity_intervalmean[, 1:3]
head(activity_impute)
head(activity_imputed)
activity_imputed$date <- as.factor(ifelse(weekdays(activity_imputed$date) %in% c("Saturday","Sunday"), "Weekend", "Weekday"))
str(activity_imputed)
xyplot(activity_imputed$interval ~ activity_imputed$steps | activity_imputed$date, layout = c(1, 2))
xyplot(activity_imputed$interval ~ activity_imputed$steps | activity_imputed$date, , type = "l", layout = c(1, 2))
xyplot(activity_imputed$steps ~ activity_imputed$interval  | activity_imputed$date, , type = "l", xlab = "interval", ylab = "Number of steps", layout = c(1, 2))
plot(activity_imputed$steps ~ activity_imputed$interval  | activity_imputed$date, , type = "l", xlab = "interval", ylab = "Number of steps", layout = c(1, 2))
str(activity_imputed)
wkdymean <- aggregate(steps ~ wkdy, data=activity_imputed, mean)
wkdymean <- aggregate(steps ~ date, data=activity_imputed, mean)
str(wkdymean)
activity_imputed <- activity_intervalmean[, 1:3]
wkdymean <- aggregate(steps ~ interval, data=activity_imputed, mean)
str(wkdymean)
head(wkdymean)
head(intervalmean)
str(activity_impute)
str(activity_imputed)
activity_imputed$wkdy <- as.factor(ifelse(weekdays(activity_imputed$wkdy) %in% c("Saturday","Sunday"), "Weekend", "Weekday"))
activity_imputed$date <- as.factor(ifelse(weekdays(activity_imputed$date) %in% c("Saturday","Sunday"), "Weekend", "Weekday"))
str(activity_imputed)
xyplot(activity_imputed$steps ~ activity_imputed$interval  | activity_imputed$date, , type = "l", xlab = "interval", ylab = "Number of steps", layout = c(1, 2))
str(wkdymean)
str(activity_imputed)
library(lattice)
set.seed(10)
x <- rnorm(100)
f <- rep(0:1, each = 50)
y <- x + f + f*x + rnorm(100, sd = 0.5)
f <- factor(f, labels = c("Group 1", "Group 2"))
xyplot(y ~ x | f, layout = c(2, 1))
library(lattice)
set.seed(10)
x <- rnorm(100)
f <- rep(0:1, each = 50)
y <- x + f + f*x + rnorm(100, sd = 0.5)
f <- factor(f, labels = c("Group 1", "Group 2"))
xyplot(y ~ x | f, layout = c(2, 1), type = "l")
library(ggplot2)
library(datasets)
data(airquality)
airquality <- transform(airquality, Month = factor(Month))
qplot(Wind, Ozone, data = airquality, facets = . ~ Month)
library(ggplot2)
library(datasets)
data(airquality)
airquality <- transform(airquality, Month = factor(Month))
qplot(Wind, Ozone, data = airquality, facets = . ~ Month, type = "l")
library(ggplot2)
library(datasets)
data(airquality)
airquality <- transform(airquality, Month = factor(Month))
qplot(Wind, Ozone, data = airquality, type = "l", facets = . ~ Month)
library(ggplot2)
g <- ggplot(movies, aes(votes, rating))
## print(g) #this gives error: no layers in plot
p <- g + geom_point()
print(p)
library(lattice)
activity_imputed$date <- as.factor(ifelse(weekdays(activity_imputed$date) %in% c("Saturday","Sunday"), "weekend", "weekday"))
xyplot(activity_imputed$steps ~ activity_imputed$interval  | activity_imputed$date, , type = "l", xlab = "interval", ylab = "Number of steps", layout = c(1, 2))
library(lattice)
activity_imputed$date <- as.factor(ifelse(weekdays(activity_imputed$date) %in% c("Saturday","Sunday"), "weekend", "weekday"))
xyplot(activity_imputed$steps ~ activity_imputed$interval  | activity_imputed$date, , type = "l", xlab = "interval", ylab = "Number of steps", layout = c(1, 2))
str(activity_impted)
str(activity_imputed)
str(dailytotal)
intervalmean <- aggregate(steps ~ interval, data=activity, mean)
with(intervalmean, plot(interval, steps, type = "l", main = "Average Steps by 5-minute Interval"))
head(activity_imputed)
activity_imputed <- activity_intervalmean[, 1:3]
head(activity_imputed)
activity_imputed$wkdy <- weekdays(activity_imputed$date)
head(activity_imputed)
activity_imputed$wkdy_wkend <- as.factor(ifelse(weekdays(activity_imputed$wkdy) %in% c("Saturday","Sunday"), "weekend", "weekday"))
str(activity_imputed)
activity_imputed$wkdy_wkend <- as.factor(ifelse(weekdays(activity_imputed$date) %in% c("Saturday","Sunday"), "weekend", "weekday"))
str(activity_imputed)
head(activity_imputed)
activity_imputed <- activity_intervalmean[, 1:3]
head(activity_imputed)
activity_imputed$wkdy_wkend <- as.factor(ifelse(weekdays(activity_imputed$date) %in% c("Saturday","Sunday"), "weekend", "weekday"))
head(activity_imputed)
str(activity_imputed)
intervalmean_imputed <- aggregate(steps ~ interval, data=activity_imputed, mean)
str(intervalmean_imputed)
str(intervalmean_imputed)
str(activity_imputed)
head(activity_imputed)
head(intervalmean_imputed)
?aggregate
intervalmean_imputed <- aggregate(steps ~ interval, data=activity_imputed, subset=activity_imputed$wkdy_wkend, mean)
str(intervalmean_imputed)
intervalmean_imputed
head(activity_imputed)
str(activity_imputed)
intervalmean_imputed <- aggregate(steps ~ interval, by = list(activity_imputed$wkdy_wkend), data=activity_imputed, mean)
intervalmean_imputed <- aggregate(steps ~ interval, by = activity_imputed$wkdy_wkend, data=activity_imputed, mean)
intervalmean_imputed <- aggregate(steps ~ interval, activity_imputed$wkdy_wkend, data=activity_imputed, mean)
intervalmean_imputed <- aggregate(steps ~ interval, activity_imputed$wkdy_wkend, data=activity_imputed, FUN = mean)
intervalmean_imputed <- aggregate(x = steps ~ interval, activity_imputed$wkdy_wkend, data=activity_imputed, FUN = mean)
testDF <- data.frame(v1 = c(1,3,5,7,8,3,5,NA,4,5,7,9),
v2 = c(11,33,55,77,88,33,55,NA,44,55,77,99) )
by1 <- c("red", "blue", 1, 2, NA, "big", 1, 2, "red", 1, NA, 12)
by2 <- c("wet", "dry", 99, 95, NA, "damp", 95, 99, "red", 99, NA, NA)
aggregate(x = testDF, by = list(by1, by2), FUN = "mean")
str(headDF)
str(testDF)
testDF
test1 <- tapply(activity_imputed, activity_imputed$wkdy_wkend, mean)
str(activity_imputed)
str(activity_imputed$wkkdy_wkend)
length(activity_imputed$wkkdy_wkend)
activity_imputed$wkkdy_wkend
activity_imputed$wkkdy_wkend[1:10]
activity_imputed$wkdy_wkend <- as.factor(ifelse(weekdays(activity_imputed$date) %in% c("Saturday","Sunday"), "weekend", "weekday"))
head(activity_imputed)
str(activity_imputed)
activity_imputed*wkdy_wkend[1:10]
activity_imputed$wkdy_wkend[1:10]
length(activity_imputed$wkdy_wkend)
test1 <- tapply(activity_imputed, activity_imputed$wkdy_wkend, mean)
wkdy <- weekdays(activity_imputed$date)
library(plyr)
wkdywkend <- mapvalues(wkdy)
wkdy <- weekdays(activity_imputed$date)
library(plyr)
wkdywkend <- mapvalues(wkdy,
c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"),
c(rep("weekday", 5), rep("weekend", 2)))
str(wkkdy)
str(wkdy)
str(wkdywkend)
str(activity_imputed)
wkdy <- as.factor(weekdays(activity_imputed$date))
str(wkdy)
library(plyr)
wkdywkend <- mapvalues(wkdy,
c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"),
c(rep("weekday", 5), rep("weekend", 2)))
str(wkdywkend)
length(wkdy)
str(wkdy)
str(wkdywkend)
length(wkdywkend)
activity_wkdy <- activity_imputed[activity_imputed$wkdy_wkend == "weekday",]
activity_wkend <- activity_imputed[activity_imputed$wkdy_wkend == "weekend",]
str(activity_wkdy)
str(activity_wkend)
head(activity_wkdy)
tail(activity_wkdy)
head(activity_wkend)
par(mfcol=c(2,1))
with(activity_wkdy, plot(interval, steps, type = "l"))
with(activity_wkend, plot(interval, steps, type = "l"))
library(ggplot2)
g <- ggplot(movies, aes(votes, rating))
## print(g) #this gives error: no layers in plot
p <- g + geom_point()
print(p)
library(ggplot2)
library(datasets)
data(airquality)
airquality <- transform(airquality, Month = factor(Month))
qplot(Wind, Ozone, data = airquality, facets = . ~ Month)
head(activity_wkdy)
head(activity_wkend)
activity_wkdymean <- aggregate(steps ~ interval, FUN = mean)
activity_wkendmean <- aggregate(steps ~ interval, FUN = mean)
activity_wkdymean <- aggregate(steps ~ interval, data=activity_wkdy, FUN = mean)
activity_wkendmean <- aggregate(steps ~ interval, data=activity_wkend, FUN = mean)
par(mfcol=c(2,1))
with(activity_wkdymean, plot(interval, steps, type = "l"))
with(activity_wkendmean, plot(interval, steps, type = "l"))
str(activity_wkdymean)
str(activity_imputed)
str(activity_wkdy)
str(activity_wkend)
library(nlme)
library(lattice)
xyplot(weight ~ Time | Diet, BodyWeight)
set.seed(10)
x <- rnorm(100)
f <- rep(0:1, each = 50)
y <- x + f + f*x + rnorm(100, sd = 0.5)
f <- factor(f, labels = c("Group 1", "Group 2"))
xyplot(y ~ x | f, panel = function(x, y,  ...) {
panel.xyplot(x, y, ...)
panel.lmline(x, y, col = 2)
})
set.seed(10)
x <- rnorm(100)
f <- rep(0:1, each = 50)
y <- x + f + f*x + rnorm(100, sd = 0.5)
f <- factor(f, labels = c("Group 1", "Group 2"))
xyplot(y ~ x | f, panel = function(x, y,  ...) {
panel.xyplot(x, y, ...)
panel.abline(h = median(y), lty = 2)
})
library(lattice)
library(datasets)
airquality <- transform(airquality, Month = factor(Month))
xyplot(Ozone ~ Wind | Month, data = airquality, layout = c(5, 1))
library(datasets)
data(airquality)
fit <- lm(Ozone ~ Wind + Temp + Solar.R, data = airquality)
library(xtable)
xt <- xtable(summary(fit))
print(xt, type = "html")
head(activity_wkdymean)
xyplot(activity_imputed$steps ~ activity_imputed$interval  | activity_imputed$wkdy_wkend, type = "l", xlab = "interval", ylab = "Number of steps", layout = c(1, 2))
par(mfcol=c(2,1))
with(activity_wkdymean, plot(interval, steps, type = "l"))
with(activity_wkendmean, plot(interval, steps, type = "l"))
par(mfcol=c(2,1))
with(activity_wkdymean, plot(interval, steps, type = "l", main = "weekday"))
with(activity_wkendmean, plot(interval, steps, type = "l", main = "weekend"))
activity_wkdymean$wdy_wkend <- "weekday"
activity_wkendmean$wdy_wkend <- "weekend"
activity_mean <- rbind(activity_wkdymean, activity_wkendmean)
str(activity_wkdymean)
head(activity_wkdymean)
activity_wkendmean$wdy_wkend <- "weekend"
head(activity_wkendmean)
str(activity_wkendmean)
activity_mean <- rbind(activity_wkdymean, activity_wkendmean)
str(activity_mean)
xyplot(activity_mean$steps ~ activity_mean$interval  | activity_mean$wkdy_wkend, type = "l", xlab = "interval", ylab = "Number of steps", layout = c(1, 2))
activity_mean <- transform(activity_mean, wdy_wkend = factor(wdy_wkend))
str(activity_mean)
xyplot(activity_mean$steps ~ activity_mean$interval  | activity_mean$wkdy_wkend, type = "l", xlab = "interval", ylab = "Number of steps", layout = c(1, 2))
activity_imputed$wkdy_wkend <- as.factor(ifelse(weekdays(activity_imputed$date) %in% c("Saturday","Sunday"), "weekend", "weekday"))
activity_wkdy <- activity_imputed[activity_imputed$wkdy_wkend == "weekday",]
activity_wkend <- activity_imputed[activity_imputed$wkdy_wkend == "weekend",]
activity_wkdymean <- aggregate(steps ~ interval, data=activity_wkdy, FUN = mean)
activity_wkendmean <- aggregate(steps ~ interval, data=activity_wkend, FUN = mean)
activity_wkdymean$wkdy_wkend <- "weekday"
activity_wkendmean$wkdy_wkend <- "weekend"
activity_mean <- rbind(activity_wkdymean, activity_wkendmean)
str(activity_mean)
activity_mean <- transform(activity_mean, wkdy_wkend = factor(wdy_wkend))
activity_mean <- transform(activity_mean, wkdy_wkend = factor(wkdy_wkend))
str(activity_mean)
xyplot(activity_mean$steps ~ activity_mean$interval  | activity_mean$wkdy_wkend, type = "l", xlab = "interval", ylab = "Number of steps", layout = c(1, 2))
?aggregate
intervalmean_imputed <- aggregate(steps ~ interval, by = activity_imputed$wkdy_wkend, data=activity_imputed, FUN = mean)
intervalmean_imputed <- aggregate(steps ~ interval, by = list(activity_imputed$wkdy_wkend), data=activity_imputed, FUN = mean)
activity_imputed$wkdy_wkend <- ifelse(weekdays(activity_imputed$date) %in% c("Saturday","Sunday"), "weekend", "weekday")
intervalmean_imputed <- aggregate(steps ~ interval, by = list(activity_imputed$wkdy_wkend), data=activity_imputed, FUN = mean)
str(activity_imputed)
wkdymean <- aggregate(steps ~ interval, data=activity_imputed[activity_imputed$wkdy_wkend == "weekday",], FUN = mean)
str(wkdymean)
str(activity_wkdymean)
wkendmean <- aggregate(steps ~ interval, data=activity_imputed[activity_imputed$wkdy_wkend == "weekend",], FUN = mean)
str(wkendmean)
str(activity_wkendmean)
wkdymean$wkdy_wkend <- "weekday"
wkendmean$wkdy_wkend <- "weekend"
intervalmean <- rbind(wkdymean, wkendmean)
intervalmean <- transform(intervalmean, wkdy_wk
wkdymean$wkdy_wkend <- "weekday"
wkendmean$wkdy_wkend <- "weekend"
intervalmean <- rbind(wkdymean, wkendmean)
str(wkdymean)
head(wkdymean)
str(wkendmean)
head(wkendmean)
str(intervalmean)
head(intervalmean)
tail(intervalmean)
xyplot(intervalmean$steps ~ intervalmean$interval  | intervalmean$wkdy_wkend, type = "l", xlab = "interval", ylab = "Number of steps", layout = c(1, 2))
head(activity_imputed)
activity_imputed <- activity_intervalmean[, 1:3]
intervalmean <- aggregate(steps ~ interval, data=activity, mean)
with(intervalmean, plot(interval, steps, type = "l", main = "Average Steps by 5-minute Interval"))
dev.copy(png, file = "./figure/intervalaveragesteps.png")
dev.off()
str(activity_imputed)
activity_imputed$wkdy_wkend <- as.factor(ifelse(weekdays(activity_imputed$date) %in% c("Saturday","Sunday"), "weekend", "weekday"))
str(activity_imputed)
wkdymean <- aggregate(steps ~ interval, data=activity_imputed[activity_imputed$wkdy_wkend == "weekday",],
FUN = mean)
wkendmean <- aggregate(steps ~ interval, data=activity_imputed[activity_imputed$wkdy_wkend == "weekend",],
FUN = mean)
wkdymean$wkdy_wkend <- "weekday"
wkendmean$wkdy_wkend <- "weekend"
intervalmean <- rbind(wkdymean, wkendmean)
intervalmean <- transform(intervalmean, wkdy_wkend = factor(wkdy_wkend))
xyplot(intervalmean$steps ~ intervalmean$interval  | intervalmean$wkdy_wkend, type = "l", xlab = "interval", ylab = "Number of steps", layout = c(1, 2))
str(activity_imputed)
head(activity_imputed)
head(wkdymean)
wkdymean <- aggregate(steps ~ interval, data=activity_imputed[activity_imputed$wkdy_wkend == "weekday",],
FUN = mean)
head(wkdymean)
